flowchart TB

%% User Interaction Layer
GUI["ðŸ§‘â€ðŸ’» User Interface (GUI, port 8000)"]

%% HTTP Communication Layer
APIGW["ðŸ›° API Gateway 
(port 8080)"]
QueueMgr["ðŸ“‹ Priority Queue Manager 
(port 8090)"]
TempGlobal["ðŸŒ¡ Global Temperature 
(port 8100)"]
PrinterMon["ðŸ–¨ Printer Monitoring 
(port 8110)"]

%% MQTT Communication Layer
JobHandler["ðŸ§  Job Handler 
(port 8115)"]
Planning["ðŸ§­ Robot Management 
(port 8120)"]
ST["ðŸ§± ST Printer 
(port 8130)"]
Anomaly["âš ï¸ Anomaly Detection 
(port 8140)"]
FanCtrl["ðŸŒ€ Fan Controller 
(port 8150)"]

%% MQTT Broker
Broker["ðŸ”— MQTT Broker 
(port 1883)"]

%% Device Layer (emoji-enhanced)
Robot["ðŸ¤– ROB Robot
(port 8160)"]
Fan["ðŸ’¨ Fan Unit
(port 8170)"]
TempSensor["ðŸŒ¡ Room Temp Sensor
(port 8180)"]

%% Data Flow 
GUI o--o|HTTP| APIGW
APIGW o--o|HTTP| QueueMgr
APIGW o--o|HTTP| TempGlobal
QueueMgr o--o|HTTP| JobHandler

TempSensor --> TempGlobal
JobHandler <--> Planning

ST --> TempGlobal 
ST --> PrinterMon
%% JobHandler --> PrinterMon (Real topic subscription)
JobHandler --> ST

Planning <--> Robot
Robot --> PrinterMon
Robot --> JobHandler 

APIGW o--o|HTTP| PrinterMon

TempGlobal --> FanCtrl
FanCtrl --> Fan

TempSensor --> Anomaly
ST --> Anomaly
Anomaly --> FanCtrl